{% extends 'base_generic.html' %}
{% load static %}
{% block content %}

<div class="post-container"> 
    <div class="post-list">
        <div class="header-section text-center mb-3">
            <h1>
                <a href="{% url 'post_list' %}">자유게시판</a>
            </h1>
            <div class="search-section d-flex justify-content-center align-items-center mt-2">
                <div class="total-count me-3">총 {{ page_obj.paginator.count }}개</div>
                <form method="GET" action="{% url 'post_list' %}" class="search-form d-flex align-items-center">
                    <select name="search_by" class="form-select me-2" aria-label="검색 기준 선택">
                        <option value="title">제목</option>
                        <option value="content">내용</option>
                        <option value="author" selected>작성자</option>
                    </select>
                    <input type="text" name="q" class="form-control search-input me-2" placeholder="검색어를 입력하세요" required>
                    <button type="submit" class="btn search-btn">검색</button>
                </form>
            </div>
        </div>

        <table class="table table-bordered">
            <thead>
                <tr>
                    <th scope="col" class="text-center">구분</th>
                    <th scope="col" class="text-center">제목</th>
                    <th scope="col" class="text-center">작성자</th>
                    <th scope="col" class="text-center">추천</th>
                    <th scope="col" class="text-center">조회수</th>
                    <th scope="col" class="text-center">작성일</th>
                </tr>
            </thead>
            <tbody>
                {% for post in page_obj %}
                <tr>
                    <td class="text-center">자유</td>
                    <td>
                        <a href="{% url 'post_detail' post.id %}" class="post-link">
                            {{ post.title }}
                            {% if post.image %}
                            <img src="{% static 'image/image_icon.png' %}" alt="" class="icon">
                            {% endif %}
                            {% if post.is_new %} 
                                <span class="new-badge">N</span>
                            {% endif %}
                        </a>
                    </td>
                    <td class="text-center">{{ post.author.username }}</td>
                    <td class="text-center">{{ post.likes }}</td>
                    <td class="text-center">{{ post.views }}</td>
                    <td class="text-center">{{ post.created_at|date:"Y.m.d" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center">게시글이 없습니다.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <a href="{% url 'post_create' %}" class="btn-success1 ms-3" style="float: right;">게시글 작성하기</a>

        <!-- 페이지 네비게이션 -->
        <div class="pagination d-flex justify-content-center align-items-center my-3">
            <div class="me-2">
                {% if page_obj.has_previous %}
                    <a href="?page={{ page_obj.previous_page_number }}" class="btn1 btnsecondary">◀</a>
                {% else %}
                    <span class="btn1 btnsecondary disabled">◀</span>
                {% endif %}
            </div>
        
            {% for num in page_obj.paginator.page_range %}
                {% if num == page_obj.number %}
                    <span class="btn btn-light">{{ num }}</span>
                {% else %}
                    <a href="?page={{ num }}" class="btn1 btnsecondary">{{ num }}</a>
                {% endif %}
            {% endfor %}

            <div class="ms-2">
                {% if page_obj.has_next %}
                    <a href="?page={{ page_obj.next_page_number }}" class="btn1 btnsecondary">▶</a>
                {% else %}
                    <span class="btn1 btnsecondary disabled">▶</span>
                {% endif %}
            </div>
        </div>
    </div>
</div> 
{% endblock %}
